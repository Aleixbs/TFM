<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
  
    <link
      href="//d500.epimg.net/cincodias/estilos/v2.x/v2.4/herramientas.css"
      rel="stylesheet"
    />
    
    <script src="sueldo.js"></script>
    <script src="redondeo.js"></script>
 
  </head>
 

      <main class="principal" id="principal">

         
                <div class="c-nomina">
                  <a name="coste_subida_fiscal"></a>
                  <div class="cal-sup">
                    <form
                      name="formulario_calculadora_irpf"
                      onKeyPress="return checkSubmit(event)"
                      class="formulario_calculadora_irpf"
                    >
                      <fieldset class="cal-datos">
                        <div class="n-general">
                          <h3>Calcular IRPF</h3>
                          <div class="c-izq">
                            <!-- sueldo bruto anual -->
                            <p class="medium">
                              <label for="bruto_anual"
                                >Sueldo bruto anual</label
                              >
                              <input
                                id="bruto_anual"
                                name="bruto_anual"
                                value="30000"
                                type="text"
                              />
                            </p>
                            <!-- Tipo de categor&iacute;a profesional -->
                            <p class="large separacion-extra">
                              <label for="categoria_profesional"
                                >* Si es un trabajador en activo, indique su
                                categoría profesional</label
                              >
                              <select
                                id="categoria_profesional"
                                name="categoria_profesional"
                              >
                                <option value="A" selected="selected">
                                  Ingenieros y Licenciados
                                </option>
                                <option value="B">
                                  Ingenieros Técnicos, Peritos y Ayudantes
                                  Titulados
                                </option>
                                <option value="C">
                                  Jefes Administrativos y de Taller
                                </option>
                                <option value="D">
                                  Ayudantes no Titulados
                                </option>
                                <option value="E">
                                  Oficiales Administrativos
                                </option>
                                <option value="F">Subalternos</option>
                                <option value="G">
                                  Auxiliares Administrativos
                                </option>
                                <option value="H">
                                  Oficiales de primera y segunda
                                </option>
                                <option value="I">
                                  Oficiales de tercera y Especialistas
                                </option>
                                <option value="J">Peones</option>
                                <option value="K">
                                  Trabajadores menores de dieciocho años,
                                  cualquiera
                                </option>
                              </select>
                            </p>
                          </div>
                          <!-- fin c-izq -->
                          <div class="c-dch">
                            <!-- edad -->
                            <p class="little">
                              <label for="edad">Edad</label>
                              <input
                                id="edad"
                                name="edad"
                                value="30"
                                type="text"
                              />
                            </p>
                            <!-- movilidad geografica -->
                            <p class="check">
                              <label for="movilidad_geografica"
                                >Movilidad geográfica</label
                              >
                              <input
                                id="movilidad_geografica"
                                name="movilidad_geografica"
                                type="checkbox"
                              />
                            </p>
                            <p class="large">
                              <label for="comunidad_autonoma"
                                >Comunidad autónoma</label
                              >
                              <select
                                id="comunidad_autonoma"
                                name="comunidad_autonoma"
                              ></select>
                            </p>
                          </div>
                          <!-- c-dch -->
                        </div>
                        <!--n-modone -->
                        <div class="plegables">
                          <div
                            class="n-general plegable"
                            id="info_datos_familiares"
                          >
                            <h3 id="datos_familiares" title="Desplegar">
                              Datos familiares
                            </h3>
                            <div class="contenido">
                              <div class="c-izq">
                                <p class="little">
                                  <label for="hijos_menores_25_anos"
                                    >Número de hijos menores de 25 años</label
                                  >
                                  <input
                                    id="hijos_menores_25_anos"
                                    name="hijos_menores_25_anos"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                                <p class="little">
                                  <label for="hijos_menores_3_anos"
                                    >De sus hijos, cuántos tienen menos de 3
                                    años</label
                                  >
                                  <input
                                    id="hijos_menores_3_anos"
                                    name="hijos_menores_3_anos"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                                <p class="check">
                                  <label
                                    class="hijos-exclusiva"
                                    for="hijos_en_exclusiva"
                                    >Tiene los hijos en exclusiva a efectos
                                    fiscales</label
                                  >
                                  <input
                                    id="hijos_en_exclusiva"
                                    name="hijos_en_exclusiva"
                                    type="checkbox"
                                  />
                                </p>
                                <p class="little">
                                  <label for="ascendente_mayor_65_menor_75"
                                    >Mayores de 65 años y menores de 75 años a
                                    cargo</label
                                  >
                                  <input
                                    id="ascendente_mayor_65_menor_75"
                                    name="ascendente_mayor_65_menor_75"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                              <!-- c-izq -->
                              <div class="c-dch">
                                <p class="little">
                                  <label for="ascendente_mayor_75"
                                    >Número de ascendientes mayores de 75 años a
                                    cargo</label
                                  >
                                  <input
                                    id="ascendente_mayor_75"
                                    name="ascendente_mayor_75"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                                <p class="little">
                                  <label for="menor_65_con_discapacidad_cargo"
                                    >Menor de 65 años a cargo con
                                    discapacidad</label
                                  >
                                  <input
                                    id="menor_65_con_discapacidad_cargo"
                                    name="menor_65_con_discapacidad_cargo"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                                <p class="little">
                                  <label
                                    class="ascendentes"
                                    for="numero_personas_deduccion_ascendientes"
                                    >Contribuyentes que aplican los mínimos por
                                    ascendiente</label
                                  >
                                  <input
                                    id="numero_personas_deduccion_ascendientes"
                                    name="numero_personas_deduccion_ascendientes"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                              <!-- c-dch -->
                            </div>
                          </div>
                          <!-- familia -->
                          <div
                            class="n-general plegable plegado"
                            id="info_minusvalia_contribuyente"
                          >
                            <h3 id="minusvalia_contribuyente" title="Desplegar">
                              Minusvalías del contribuyente
                            </h3>
                            <div class="contenido">
                              <div class="c-izq">
                                <p class="check">
                                  <label
                                    class="hijos-exclusiva"
                                    for="minusvalia_33_al_65"
                                    >Minusvalía entre el 33% y el 65%</label
                                  >
                                  <input
                                    id="minusvalia_33_al_65"
                                    name="minusvalia_33_al_65"
                                    type="checkbox"
                                  />
                                </p>
                              </div>
                              <div class="c-dch">
                                <p class="check">
                                  <label
                                    class="hijos-exclusiva"
                                    for="minusvalia_sup_al_65"
                                    >Minusvalía superior al 65% o con movilidad
                                    reducida</label
                                  >
                                  <input
                                    id="minusvalia_sup_al_65"
                                    name="minusvalia_sup_al_65"
                                    type="checkbox"
                                  />
                                </p>
                              </div>
                            </div>
                          </div>
                          <div
                            class="n-general plegable plegado"
                            id="info_minusvalia_hijos"
                          >
                            <h3 id="minusvalia_hijos" title="Desplegar">
                              Minusvalías de los hijos
                            </h3>
                            <div class="contenido">
                              <div class="c-izq">
                                <p class="little">
                                  <label
                                    for="descendientes_con_minusvalia_33_al_65"
                                    >Número de descendientes con grado de
                                    minusvalía entre 33% y 65%</label
                                  >
                                  <input
                                    id="descendientes_con_minusvalia_33_al_65"
                                    name="descendientes_con_minusvalia_33_al_65"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                              <div class="c-dch">
                                <p class="little">
                                  <label
                                    for="descendientes_con_minusvalia_sup_al_65"
                                    >Número de descendientes con grado de
                                    minusvalía superior al 65%</label
                                  >
                                  <input
                                    id="descendientes_con_minusvalia_sup_al_65"
                                    name="descendientes_con_minusvalia_sup_al_65"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                            </div>
                          </div>
                          <div
                            class="n-general plegable plegado"
                            id="info_minusvalia_mayores"
                          >
                            <h3 id="minusvalia_mayores" title="Desplegar">
                              Minusvalías de los mayores a cargo
                            </h3>
                            <div class="contenido">
                              <div class="c-izq">
                                <p class="little">
                                  <label
                                    for="ascendientes_con_minusvalia_33_al_65"
                                    >Número de ascendientes con grado de
                                    minusvalía &gt;=33% y &lt;65%
                                  </label>
                                  <input
                                    id="ascendientes_con_minusvalia_33_al_65"
                                    name="ascendientes_con_minusvalia_33_al_65"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                              <div class="c-dch">
                                <p class="little">
                                  <label
                                    for="ascendientes_con_minusvalia_sup_al_65"
                                    >Número de ascendientes con grado de
                                    minusvalía &gt;=65%</label
                                  >
                                  <input
                                    id="ascendientes_con_minusvalia_sup_al_65"
                                    name="ascendientes_con_minusvalia_sup_al_65"
                                    value="0"
                                    type="text"
                                  />
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </fieldset>
                      <fieldset class="c-boton">
                        <input
                          class="boton"
                          id="calcular_nomina"
                          name="calcular"
                          value="calcular"
                          onclick="f_calcular_resultado();"
                          type="button"
                        />
                        <div class="error" id="error"></div>
                      </fieldset>
                    </form>
                  </div>
                  <div
                    id="resultados_calculadora_nomina"
                    class="oculto tabla-resultados"
                  >
                    <a name="tabla_resultados" id="ancla_tabla_resultados"></a>
                    <table>
                      <thead></thead>
                      <tbody>
                        <tr>
                          <th class="" scope="row">Sueldo bruto anual</th>
                          <td><div id="sueldo_bruto">--</div></td>
                        </tr>
                        <tr>
                          <th class="" scope="row">Cuota a pagar en el IRPF</th>
                          <td><div id="cuota_irpf">--</div></td>
                        </tr>
                        <tr>
                          <th class="" scope="row">
                            Cuotas a la Seguridad Social
                          </th>
                          <td><div id="cuota_segsocial">--</div></td>
                        </tr>
                        <tr>
                          <th class="" scope="row">Sueldo neto anual</th>
                          <td><div id="sueldo_neto">--</div></td>
                        </tr>
                        <tr>
                          <th class="" scope="row">
                            Tipo de retención en el IRPF
                          </th>
                          <td><div id="tipo_retencion_irpf">--</div></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <script>
                  if (document.addEventListener) {
                    window.addEventListener(
                      "DOMContentLoaded",
                      f_inicializa,
                      false
                    );
                  } else {
                    window.attachEvent("onload", f_inicializa); //IE
                  }

                  function f_inicializa() {
                    ponerFoco();
                    // carga las comunidades
                    f_carga_comunidades("comunidad_autonoma");
                  }

                  function f_calcular_resultado() {
                    // evento para marcado
                    f_cal_marcado("cincodias calculadora irpf");

                    // valida campos
                    var campos = f_cal_valida_datos();
                    if (campos === false) {
                      return false;
                    }

                    var bruto_anual = campos["bruto_anual"];
                    var categoria_profesional = campos["categoria_profesional"];
                    var comunidad_autonoma = campos["comunidad_autonoma"];

                    /* base imponible */
                    var base_imponible = f_calcular_base_imponible(
                      bruto_anual,
                      categoria_profesional
                    );
                    var minimo_personal = f_calcular_minimo_personal(campos);
                    // comunidad + estatal
                    var cuota_retencion =
                      f_calcular_tramos_base_liquidable_comunidad(
                        base_imponible,
                        comunidad_autonoma
                      ) +
                      f_calcular_tramos_base_liquidable_comunidad(
                        base_imponible,
                        "E"
                      ) -
                      (f_calcular_tramos_base_liquidable_comunidad(
                        minimo_personal,
                        comunidad_autonoma
                      ) +
                        f_calcular_tramos_base_liquidable_comunidad(
                          minimo_personal,
                          "E"
                        ));

                    /* IRPF */
                    var cuota_irpf = cuota_retencion;
                    if (cuota_irpf < 0) cuota_irpf = 0;

                    /* Sueldos netos */
                    var sueldo_neto = f_calcular_sueldo_neto(
                      bruto_anual,
                      categoria_profesional,
                      cuota_irpf
                    ).toFixed(1);

                    var tipo_medio_sobre_rendimiento_neto =
                      f_calcular_tipo_medio_sobre_rendimiento_neto(
                        bruto_anual,
                        categoria_profesional,
                        cuota_irpf
                      );
                    var aux_tipo_medio_sobre_sueldo_bruto =
                      (cuota_irpf * 100) / bruto_anual;
                    var tipo_medio_sobre_sueldo_bruto = (
                      (aux_tipo_medio_sobre_sueldo_bruto + 100).toFixed(2) - 100
                    ).toFixed(2);
                    // cuotas a la seguridad social
                    var cuota_segsocial = formatNumber(
                      (
                        f_calcuar_cuota_mensual_pagar(
                          bruto_anual,
                          categoria_profesional
                        ) * 12
                      ).toFixed(1)
                    );

                    // Resultados
                    // baja a la capa resultados
                    document.getElementById("calcular_nomina").scrollIntoView();
                    //
                    document.getElementById("sueldo_bruto").innerHTML =
                      formatNumber(bruto_anual) + " €";
                    document.getElementById("cuota_irpf").innerHTML =
                      formatNumber(cuota_irpf.toFixed(1)) + " €";
                    document.getElementById("cuota_segsocial").innerHTML =
                      cuota_segsocial + " €";
                    document.getElementById("sueldo_neto").innerHTML =
                      formatNumber(sueldo_neto) + " €";
                    document.getElementById("tipo_retencion_irpf").innerHTML =
                      formatNumber(tipo_medio_sobre_sueldo_bruto);

                    var irpfw = document.getElementById("tipo_retencion_irpf").innerHTML =
                      formatNumber(tipo_medio_sobre_sueldo_bruto);
                      console.log ('aqui', irpfw)
                      
            

                    // muestra capa resultados
                    document.getElementById(
                      "resultados_calculadora_nomina"
                    ).className = "";
                    document.getElementById("error").innerHTML = "";
                  }

                  // muestra / oculta capa
                  document.getElementById("datos_familiares").onclick =
                    function (e) {
                      f_cal_oculto_visible("info_datos_familiares", "plegado");
                    };
                  document.getElementById("minusvalia_contribuyente").onclick =
                    function (e) {
                      f_cal_oculto_visible(
                        "info_minusvalia_contribuyente",
                        "plegado"
                      );
                    };
                  document.getElementById("minusvalia_hijos").onclick =
                    function (e) {
                      f_cal_oculto_visible("info_minusvalia_hijos", "plegado");
                    };
                  document.getElementById("minusvalia_mayores").onclick =
                    function (e) {
                      f_cal_oculto_visible(
                        "info_minusvalia_mayores",
                        "plegado"
                      );
                    };
                </script>

  </body>
</html>
